(this["webpackJsonpavito-test"]=this["webpackJsonpavito-test"]||[]).push([[0],{126:function(e,t,n){e.exports=n(246)},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},135:function(e,t,n){},139:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){},245:function(e,t,n){},246:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(47),o=n.n(c),l=(n(131),n(132),n(133),function(){return r.a.createElement("header",null,r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"header__title"},"Test APP")))}),i=(n(134),function(){return r.a.createElement("footer",null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"footer__line"}),r.a.createElement("div",{className:"footer__content"},"\xa9 2018-2019")))}),u=n(16),s=n(22),m=n(27),p=n(23),d=n(28),E=(n(135),n(7)),f=(n(139),function(){return r.a.createElement("section",{className:"preloader"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"preloader__content"},r.a.createElement("div",{className:"loadingio-spinner-spinner-6vvc926xcyi"},r.a.createElement("div",{className:"ldio-d4sfda2o76s"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))))))}),h=n(13),g=n.n(h),v=n(38),b=function e(){var t=this;Object(u.a)(this,e),this.baseUrl="https://boiling-refuge-66454.herokuapp.com/",this.getData=function(){var e=Object(v.a)(g.a.mark((function e(n){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t.baseUrl).concat(n));case 2:if(!(a=e.sent).ok){e.next=9;break}return e.next=6,a.json();case 6:return e.abrupt("return",e.sent);case 9:return e.abrupt("return",new Error);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAllImages=Object(v.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getData("images");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.getFullImageData=function(){var e=Object(v.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getData("images/".concat(n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.postComment=function(){var e=Object(v.a)(g.a.mark((function e(n,a,r){var c,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={name:n.name,comment:n.comment,id:a,date:r},o="".concat(t.baseUrl,"images/").concat(a,"/comments"),e.prev=2,e.next=5,fetch(o,{method:"POST",body:JSON.stringify(c),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return c}));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n,a){return e.apply(this,arguments)}}()},O=(n(141),Object(E.b)(null,(function(e){return{onShowPopup:function(t){return e(function(e){return{type:"SHOW_POPUP",payload:e}}(t))}}}))((function(e){var t=e.id,n=e.url,a=e.onShowPopup;return r.a.createElement("div",{className:"gallery__image",onClick:function(){return a(t)}},r.a.createElement("img",{src:n,alt:""}))}))),y=(n(142),n(98)),j=n.n(y),N=function(){return r.a.createElement("section",{className:"error"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"error__content"},r.a.createElement("img",{className:"error__content-image",src:j.a,alt:"error"}),r.a.createElement("h2",{className:"error__content-text"},"\u0427\u0442\u043e-\u0442\u043e \u043d\u0435 \u0442\u0430\u043a \u0441 \u0412\u0430\u0448\u0438 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435\u043c"))))},_=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new b,n=this.props,a=n.onStartLoading,r=n.onGetImages;a(),t.getAllImages().then((function(e){return r(e)})).catch((function(){return e.props.onGetError()}))}},{key:"render",value:function(){var e=this.props.images;return e?this.props.hasError?r.a.createElement(N,null):r.a.createElement("section",{className:"gallery"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"gallery__content"},e.map((function(e){return r.a.createElement(O,Object.assign({key:e.id},e))}))))):r.a.createElement(f,null)}}]),t}(a.Component),C=Object(E.b)((function(e){return{images:e.galleryReducer.images,loading:e.galleryReducer.loading,hasError:e.galleryReducer.hasError}}),(function(e){return{onStartLoading:function(){return e({type:"FETCH_ALL_IMAGES"})},onGetImages:function(t){return e(function(e){return{type:"GET_IMAGES",payload:e}}(t))},onGetError:function(){return e({type:"HAS_ERROR"})}}}))(_),w=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={hasError:!1},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(N,null):this.props.children}}]),t}(a.Component),S=(n(143),n(144),n(94)),k=n(95),I=(n(145),n(146),function(){return r.a.createElement("div",{className:"loadingio-spinner-ellipsis-u63xtythb5"},r.a.createElement("div",{className:"ldio-54li72kx3co"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)))}),R=Object(E.b)((function(e){return{loadComment:e.popupReducer.sendingComment}}))((function(e){return r.a.createElement("button",null,e.loadComment?r.a.createElement(I,null):"\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439")})),D=Object(k.a)({form:"commentForm"})((function(e){return r.a.createElement("form",{className:"popup-form",onSubmit:e.handleSubmit},r.a.createElement(S.a,{required:!0,type:"text",name:"name",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",component:"input"}),r.a.createElement(S.a,{required:!0,type:"text",name:"comment",placeholder:"\u0412\u0430\u0448 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",component:"input"}),r.a.createElement(R,null))})),G=(n(245),function(e){var t=e.date.toString();t=t.substr(0,t.length-3);var n=new Date(1e3*+t),a=n.getDate()<10?"0".concat(n.getDate()):n.getDate(),c=n.getMonth()+1<10?"0".concat(n.getMonth()+1):n.getMonth()+1,o=n.getFullYear(),l="".concat(a,".").concat(c,".").concat(o);return r.a.createElement("div",{className:"comment-item"},r.a.createElement("span",{className:"date"},l),r.a.createElement("i",{className:"comment-name"},e.name,":"),r.a.createElement("p",{className:"comment-text"},e.comment))}),P=n(49),A=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleFormSubmit=function(e){n.props.onSendComment();var t=new b,a=n.props.id,r=Date.now();t.postComment(e,a,r).then((function(e){n.props.onGetComment(e),n.props.clearForm()}))},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=new b,t=this.props,n=t.id,a=t.onGetImageDetails;e.getFullImageData(n).then((function(e){return a(e)}))}},{key:"render",value:function(){var e,t=this.props,n=t.image,a=t.onClosePopup,c=t.comments;if(t.hasError)return r.a.createElement(N,null);if(n&&c&&0!==c.length){var o=c.filter((function(e){return e.id===n.id}));o&&(e=o.map((function(e,t){return r.a.createElement(G,Object.assign({key:t},e))})))}return r.a.createElement("section",{className:"popup"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"popup-block"},r.a.createElement("div",{className:"image-side"},n?r.a.createElement("img",{src:n?n.url:void 0,alt:""}):r.a.createElement(f,null)),r.a.createElement(D,{onSubmit:this.handleFormSubmit}),r.a.createElement("div",{className:"comments-side"},c?0===c.length?"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u0432 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442":e:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u0432 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442"),r.a.createElement("div",{className:"close-btn",onClick:function(){return a()}},r.a.createElement("span",null)))))}}]),t}(a.Component),M=Object(E.b)((function(e){return{id:e.popupReducer.currentImageId,load:e.popupReducer.loading,image:e.popupReducer.imageDetails,loadComment:e.popupReducer.sendingComment,comments:e.popupReducer.comments,hasError:e.galleryReducer.hasError}}),(function(e){return{onSendComment:function(){return e({type:"SENT_COMMENT"})},onClosePopup:function(){return e({type:"CLOSE_POPUP"})},onGetImageDetails:function(t){return e(function(e){return{type:"GET_IMAGE_DETAILS",payload:e}}(t))},onGetComment:function(t){return e(function(e){return{type:"GET_COMMENT",payload:e}}(t))},clearForm:function(){return e(P.a.apply(void 0,["commentForm",!1,!1].concat(["name","comment"])))},onGetError:function(){return e({type:"HAS_ERROR"})}}}))(A),x=Object(E.b)((function(e){return{isPopup:e.popupReducer.isOpen}}))((function(e){var t=e.isPopup;return r.a.createElement("div",{className:"app"},r.a.createElement(l,null),r.a.createElement(w,null,r.a.createElement(C,null)),r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"It is a test task from Avito. ",r.a.createElement("br",null),"Link: ",r.a.createElement("a",{href:"https://github.com/avito-tech/safedeal-frontend-trainee"},"Click here to read"),r.a.createElement("br",null),r.a.createElement("i",null,"Made by ",r.a.createElement("a",{href:"https://github.com/kyrsanter"},"kyrsanter")))),r.a.createElement(i,null),t?r.a.createElement(M,null):null)}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var T=n(6),F=n(12),L={images:null,loading:!1,hasError:!1},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_ALL_IMAGES":return Object(F.a)({},e,{loading:!0});case"GET_IMAGES":return Object(F.a)({},e,{loading:!1,images:t.payload});case"HAS_ERROR":return Object(F.a)({},e,{hasError:!0});default:return e}},U=n(100),W={loading:!1,isOpen:!1,currentImageId:null,imageDetails:null,sendingComment:!1,comments:null},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_POPUP":return Object(F.a)({},e,{isOpen:!0,loading:!0,currentImageId:t.payload});case"GET_IMAGE_DETAILS":return Object(F.a)({},e,{loading:!1,imageDetails:t.payload});case"CLOSE_POPUP":return Object(F.a)({},e,{isOpen:!1,imageDetails:null});case"SENT_COMMENT":return Object(F.a)({},e,{sendingComment:!0});case"GET_COMMENT":var n=[];return n=e.comments?[].concat(Object(U.a)(e.comments),[t.payload]):[t.payload],Object(F.a)({},e,{sendingComment:!1,comments:n});default:return e}},q=n(96),B=Object(T.b)({galleryReducer:H,popupReducer:J,form:q.a}),Y=Object(T.c)(B),$=r.a.createElement(E.a,{store:Y},r.a.createElement(x,null));o.a.render($,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},98:function(e,t,n){e.exports=n.p+"static/media/error-image.79a8a2f3.png"}},[[126,1,2]]]);
//# sourceMappingURL=main.015a1ee4.chunk.js.map